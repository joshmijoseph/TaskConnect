<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings Page</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(function() {
            debugger;
           $("#header").load("Header.html");
        });
     </script>
    <link href="toggleswitch.css" rel="stylesheet">
    <style>
    .container {
        margin-top: 3px; /*add the small margin at top*/
        background-color:#2E4272;
        display: flex;
        height: 100vh; /*spans 100% of vert. viewport*/
        padding: 0px;
    }
    .middle-col {
        background-color:#ffffff;
        flex-grow: 1;
        padding: 20px;
    }
    .optionsSection {
        padding: 10px;
    }
    .button {
        margin-right: 10px;
        border: 2px solid #000000; 
        padding: 5px 10px; 
        text-decoration: none; 
        display: inline-block; 
        border-radius: 5px;
    }
    .currentEmail {
        padding: 10px 50px;
        margin-bottom: 10px; /*adds space b/w form inputs*/
        border: 1px solid #ccc;
    }
    .currentPassword {
        padding: 10px 50px;
        margin-bottom: 10px; /*adds space b/w form inputs*/
        border: 1px solid #ccc;
    }
    </style>

    <script>
        $(function() {
            $("#header").load("Header.html", function() {
                const usernameContainer = document.getElementById('usernameContainer');
                const currentUsernameBox = document.getElementById('currentUsernameBox');
                const currentUsername = document.getElementById('currentUsername');
                const editUsernameIcon = document.getElementById('editUsernameIcon');
                const profileForm = document.getElementById('profileForm');
                const newUsernameInput = document.getElementById('newUsername');
                const updateUsernameButton = document.getElementById('updateUsername');

                editUsernameIcon.addEventListener('click', () => {
                currentUsernameBox.style.display = 'none';
                profileForm.style.display = 'block';
                });

                updateUsernameButton.addEventListener('click', async () => {
                const newUsername = newUsernameInput.value;
                
                if (!newUsername) {
                    alert('Please enter a new username.');
                    return;
                }
                
                try {
                    const response = await fetch('/updateUsername', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ newUsername })
                    });

                    if (response.ok) {
                    currentUsername.textContent = newUsername;
                    currentUsernameBox.style.display = 'block';
                    profileForm.style.display = 'none';
                    alert('Username updated successfully');
                    } else {
                    alert('Error updating username');
                    }
                } catch (error) {
                    console.error('Error:', error);
                }
                });
            });
        });
    </script>
</head>
<body>
    <header id = "header"></header>
    <div class="container">
        <div class="middle-col">
            <h1>Settings Page</h1>
            <div class="optionsSection">
                <div>
                    <h2>Change Profile Picture</h2>
                    <a href="profile_picture.html" class="button">Change or Add Profile Icon</a>
                </div>
                <div>
                    <h2>Change Email</h2>
                    <p>
                        <input type="text" class="currentEmail" placeholder="johndoe@gmail.com" required>
                        <a href="change_email.html" class="button">Change Email</a>
                    </p>
                </div>
                <div>
                    <h2>Change Password</h2>
                    <p>
                        <input type="text" class="currentPassword" placeholder="johndoe%9876" required>
                        <a href="change_password.html" class="button">Change Password</a>
                    </p>
                </div>
                <div>
                    <h2>Log Out</h2>
                    <a href="loginpage.html" class="button">Log Out</a>
                </div>
                <div>
                    <h2>Share Activity</h2>
                    <label for="shareToggle">Share personal tasks with friend</label>
                    <!-- <input type="checkbox" id="shareToggle"> -->
                    <!-- Rounded switch -->
                    <label class="switch">
                      <input type="checkbox">
                      <span class="slider round"></span>
                    </label>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
